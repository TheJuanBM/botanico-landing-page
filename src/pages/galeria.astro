---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import Hero from '../components/Hero.astro';
import Footer from '../components/Footer.astro';
import { rooms } from '../services/rooms';
import PiscinaImg from '../assets/botanico/images/hero-1.avif';
import EntradaImg from '../assets/botanico/images/hero-3.avif';
import EventoImg from '../assets/botanico/images/evento-corporativo.webp';
import EventoPrivadoImg from '../assets/botanico/images/evento-privado.webp';
import AtardecerImg from '../assets/mito/images/atardecer.jpg';
import PostresPremiumImg from '../assets/mito/images/postre.webp';

// Gallery categories with icons
const categories = [
  { name: 'Todas', icon: 'M4 6h16M4 12h16M4 18h16' },
  {
    name: 'Habitaciones',
    icon: 'M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6',
  },
  {
    name: 'MITO Rooftop',
    icon: 'M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z',
  },
  {
    name: 'Instalaciones',
    icon: 'M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4',
  },
  {
    name: 'Gastronomía',
    icon: 'M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253',
  },
  {
    name: 'Eventos',
    icon: 'M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z',
  },
];

// Gallery images with sizes for masonry layout
const galleryImages = [
  {
    category: 'Habitaciones',
    alt: 'Suite Estandar',
    title: 'Suite Estandar',
    src: rooms[0].img,
    size: 'large',
  },
  {
    category: 'MITO Rooftop',
    alt: 'Vista panorámica MITO',
    title: 'Rooftop MITO',
    src: 'https://images.trvl-media.com/lodging/107000000/106490000/106485200/106485150/10213ec9.jpg?impolicy=resizecrop&rw=1200&ra=fit',
    size: 'medium',
  },
  {
    category: 'Instalaciones',
    alt: 'Lobby Hotel Botánico',
    title: 'Lobby Principal',
    src: 'https://images.trvl-media.com/lodging/107000000/106490000/106485200/106485150/dc17e1c5.jpg?impolicy=resizecrop&rw=1200&ra=fit',
    size: 'small',
  },
  {
    category: 'Gastronomía',
    alt: 'Plato gourmet',
    title: 'Gastronomía de Autor',
    src: 'https://images.cluvi.com/W53C9mSVdr/w_1200_W53C9mSVdr_lomo-al-vino-tinto.jpg',
    size: 'tall',
  },
  {
    category: 'Habitaciones',
    alt: 'Suite con Balcón',
    title: 'Suite con Balcón',
    src: rooms[1].img,
    size: 'medium',
  },
  {
    category: 'MITO Rooftop',
    alt: 'Bar MITO',
    title: 'Bar MITO',
    src: 'https://images.trvl-media.com/lodging/107000000/106490000/106485200/106485150/10d06bc1.jpg?impolicy=resizecrop&rw=1200&ra=fit',
    size: 'small',
  },
  {
    category: 'Instalaciones',
    alt: 'Piscina',
    title: 'Área de Piscina',
    src: PiscinaImg.src,
    size: 'wide',
  },
  {
    category: 'Instalaciones',
    alt: 'Entrada',
    title: 'Área de Entrada',
    src: EntradaImg.src,
    size: 'wide',
  },
  {
    category: 'Eventos',
    alt: 'Evento corporativo',
    title: 'Eventos Corporativos',
    src: EventoImg.src,
    size: 'small',
  },
  {
    category: 'Habitaciones',
    alt: 'Twin Estandar',
    title: 'Twin Estandar',
    src: rooms[2].img,
    size: 'medium',
  },
  {
    category: 'Gastronomía',
    alt: 'Cóctel de autor',
    title: 'Coctelería Premium',
    src: 'https://images.cluvi.com/MMqvw4JSSi/w_1200_MMqvw4JSSi_dsc01508.jpg',
    size: 'small',
  },
  {
    category: 'Gastronomía',
    alt: 'Postres Premium',
    title: 'Postres Premium',
    src: PostresPremiumImg.src,
    size: 'small',
  },
  {
    category: 'MITO Rooftop',
    alt: 'Atardecer en MITO',
    title: 'Atardecer Dorado',
    src: AtardecerImg.src,
    size: 'large',
  },
  {
    category: 'Habitaciones',
    alt: 'Twin con Balcón',
    title: 'Twin con Balcón',
    src: rooms[3].img,
    size: 'small',
  },
  {
    category: 'Eventos',
    alt: 'Celebración privada',
    title: 'Eventos Privados',
    src: EventoPrivadoImg.src,
    size: 'tall',
  },
  {
    category: 'Habitaciones',
    alt: 'Master Suite',
    title: 'Master Suite',
    src: rooms[4].img,
    size: 'wide',
  },
];

// Count images per category
const getCategoryCount = (categoryName: string) => {
  if (categoryName === 'Todas') return galleryImages.length;
  return galleryImages.filter((img) => img.category === categoryName).length;
};
---

<Layout
  title="Galería de Fotos | Suites de Lujo y Rooftop Premium - Hotel Botánico"
  description="Descubre las suites de lujo, MITO Rooftop premium e instalaciones exclusivas de Hotel Botánico Caucasia. Fotos de habitaciones, piscina y servicios incluidos. Reserva ahora."
  keywords="fotos suites lujo hotel botánico, galería hotel premium Caucasia, imágenes MITO rooftop, habitaciones incluido desayuno"
>
  <Navbar />

  <main id="main-content">
    <Hero
      backgroundImage={AtardecerImg.src}
      title="Galería"
      subtitle="Descubre la elegancia y el confort que te espera"
      height="medium"
      showCTA={false}
    />

    <!-- Intro Section with animated text -->
    <section
      class="py-16 md:py-24 bg-gradient-to-b from-white via-beige-premium/30 to-white relative overflow-hidden"
    >
      <!-- Decorative elements -->
      <div
        class="absolute top-0 left-0 w-72 h-72 bg-verde-oliva/5 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2"
      >
      </div>
      <div
        class="absolute bottom-0 right-0 w-96 h-96 bg-cafe-claro/10 rounded-full blur-3xl translate-x-1/3 translate-y-1/3"
      >
      </div>

      <div class="container mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
        <div class="max-w-4xl mx-auto text-center">
          <div
            class="inline-flex items-center gap-2 px-4 py-2 bg-verde-oliva/10 rounded-full mb-6 animate-fade-in"
          >
            <span class="w-2 h-2 bg-verde-oliva rounded-full animate-pulse"></span>
            <span class="text-verde-oliva font-medium text-sm tracking-wider uppercase"
              >Explora nuestros espacios</span
            >
          </div>
          <p
            class="text-xl md:text-2xl text-gray-600 leading-relaxed font-light animate-fade-in-up"
            style="animation-delay: 0.2s"
          >
            Una imagen vale más que mil palabras. <span class="text-verde-oliva font-medium"
              >Descubre por qué somos el hotel preferido</span
            > en el Bajo Cauca a través de nuestra colección visual.
          </p>
        </div>
      </div>
    </section>

    <!-- Filter Section -->
    <section
      class="py-8 sticky top-16 z-40 bg-white/80 backdrop-blur-lg border-b border-beige-premium/50 shadow-sm"
    >
      <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex flex-wrap justify-center gap-2 md:gap-3" id="filter-buttons">
          {
            categories.map((category, index) => (
              <button
                class:list={[
                  'group relative px-4 md:px-6 py-2.5 md:py-3 rounded-xl font-medium transition-all duration-500 filter-btn flex items-center gap-2',
                  index === 0
                    ? 'bg-verde-oliva text-white shadow-lg shadow-verde-oliva/25'
                    : 'bg-beige-premium/50 text-negro-suave hover:bg-verde-oliva hover:text-white hover:shadow-lg hover:shadow-verde-oliva/25',
                ]}
                data-category={category.name}
              >
                <svg
                  class="w-4 h-4 md:w-5 md:h-5 transition-transform duration-300 group-hover:scale-110"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="1.5"
                    d={category.icon}
                  />
                </svg>
                <span class="hidden sm:inline">{category.name}</span>
                <span
                  class="absolute -top-2 -right-2 w-5 h-5 md:w-6 md:h-6 bg-verde-oliva text-white text-xs font-bold rounded-full flex items-center justify-center transform scale-0 group-hover:scale-100 transition-transform duration-300 count-badge"
                  data-count={getCategoryCount(category.name)}
                >
                  {getCategoryCount(category.name)}
                </span>
              </button>
            ))
          }
        </div>
      </div>
    </section>

    <!-- Gallery Grid - Bento Style -->
    <section class="py-12 md:py-20 bg-gradient-to-b from-white to-beige-premium/20 relative">
      <!-- Subtle pattern overlay -->
      <div
        class="absolute inset-0 opacity-[0.02]"
        style="background-image: url(&quot;data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23615A40' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E&quot;);"
      >
      </div>

      <div class="container mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
        <!-- Gallery counter -->
        <div class="flex items-center justify-between mb-8">
          <p class="text-gray-500 text-sm">
            Mostrando <span id="visible-count" class="font-semibold text-verde-oliva"
              >{galleryImages.length}</span
            > de {galleryImages.length} imágenes
          </p>
          <div class="hidden md:flex items-center gap-2 text-sm text-gray-500">
            <span>Click para ampliar</span>
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"></path>
            </svg>
          </div>
        </div>

        <!-- Bento Grid -->
        <div
          class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-4 lg:gap-5 auto-rows-[180px] md:auto-rows-[220px] lg:auto-rows-[260px]"
          id="gallery-grid"
        >
          {
            galleryImages.map((image, index) => {
              // Determine grid span based on size
              const sizeClasses = {
                small: '',
                medium: 'md:col-span-1 md:row-span-1',
                large: 'col-span-2 row-span-2',
                tall: 'row-span-2',
                wide: 'col-span-2',
              };

              return (
                <div
                  class:list={[
                    'gallery-item group cursor-pointer overflow-hidden rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-500 relative',
                    sizeClasses[image.size as keyof typeof sizeClasses] || '',
                  ]}
                  data-category={image.category}
                  data-index={index}
                  data-src={image.src}
                  data-title={image.title}
                  style={`animation-delay: ${index * 0.05}s`}
                >
                  {/* Image container with parallax effect */}
                  <div class="absolute inset-0 overflow-hidden">
                    {image.src ? (
                      <img
                        src={image.src}
                        alt={image.alt}
                        loading="lazy"
                        class="w-full h-full object-cover transition-transform duration-700 ease-out group-hover:scale-110"
                      />
                    ) : (
                      <div class="w-full h-full bg-gradient-to-br from-cafe-claro to-verde-oliva opacity-30" />
                    )}
                  </div>

                  {/* Gradient overlay */}
                  <div class="absolute inset-0 bg-gradient-to-t from-negro-suave/80 via-negro-suave/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500" />

                  {/* Category badge */}
                  <div class="absolute top-3 left-3 md:top-4 md:left-4">
                    <span class="inline-flex items-center px-2 py-1 md:px-3 md:py-1.5 bg-white/90 backdrop-blur-sm rounded-full text-xs font-medium text-negro-suave shadow-sm transform -translate-y-2 opacity-0 group-hover:translate-y-0 group-hover:opacity-100 transition-all duration-500">
                      {image.category}
                    </span>
                  </div>

                  {/* Zoom icon */}
                  <div class="absolute top-3 right-3 md:top-4 md:right-4">
                    <div class="w-8 h-8 md:w-10 md:h-10 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center shadow-sm transform translate-y-2 opacity-0 group-hover:translate-y-0 group-hover:opacity-100 transition-all duration-500 delay-75">
                      <svg
                        class="w-4 h-4 md:w-5 md:h-5 text-verde-oliva"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"
                        />
                      </svg>
                    </div>
                  </div>

                  {/* Title info */}
                  <div class="absolute bottom-0 left-0 right-0 p-3 md:p-4 lg:p-5 transform translate-y-full group-hover:translate-y-0 transition-transform duration-500">
                    <p class="text-white font-serif text-lg md:text-xl lg:text-2xl font-semibold mb-1">
                      {image.title}
                    </p>
                    <div class="flex items-center gap-2 text-beige-premium/80 text-sm">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                        />
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                        />
                      </svg>
                      <span>Ver en detalle</span>
                    </div>
                  </div>

                  {/* Corner accent */}
                  <div class="absolute bottom-0 right-0 w-16 h-16 md:w-20 md:h-20 overflow-hidden opacity-0 group-hover:opacity-100 transition-opacity duration-500">
                    <div class="absolute bottom-0 right-0 w-full h-full bg-verde-oliva transform rotate-45 translate-x-1/2 translate-y-1/2" />
                  </div>
                </div>
              );
            })
          }
        </div>
      </div>
    </section>

    <!-- Lightbox Modal -->
    <div
      id="lightbox"
      class="fixed inset-0 z-50 bg-negro-suave/95 backdrop-blur-xl opacity-0 pointer-events-none transition-all duration-500 flex items-center justify-center"
    >
      <!-- Close button -->
      <button
        id="lightbox-close"
        aria-label="Cerrar galería"
        class="absolute top-4 right-4 md:top-8 md:right-8 w-12 h-12 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center transition-all duration-300 group z-20"
      >
        <svg
          class="w-6 h-6 text-white group-hover:rotate-90 transition-transform duration-300"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>

      <!-- Navigation -->
      <button
        id="lightbox-prev"
        aria-label="Imagen anterior"
        class="absolute left-2 md:left-8 top-1/2 -translate-y-1/2 w-12 h-12 md:w-14 md:h-14 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center transition-all duration-300 group z-20"
      >
        <svg
          class="w-6 h-6 text-white group-hover:-translate-x-1 transition-transform duration-300"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"
          ></path>
        </svg>
      </button>
      <button
        id="lightbox-next"
        aria-label="Imagen siguiente"
        class="absolute right-2 md:right-8 top-1/2 -translate-y-1/2 w-12 h-12 md:w-14 md:h-14 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center transition-all duration-300 group z-20"
      >
        <svg
          class="w-6 h-6 text-white group-hover:translate-x-1 transition-transform duration-300"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"
          ></path>
        </svg>
      </button>

      <!-- Image container -->
      <div class="relative max-w-6xl max-h-[85vh] mx-4 md:mx-8">
        <img
          id="lightbox-img"
          src=""
          alt=""
          class="max-w-full max-h-[80vh] object-contain rounded-lg shadow-2xl transform scale-95 transition-transform duration-500"
        />
        <div
          id="lightbox-info"
          class="absolute bottom-0 left-0 right-0 p-4 md:p-6 bg-gradient-to-t from-negro-suave/80 to-transparent rounded-b-lg"
        >
          <h2 id="lightbox-title" class="text-white font-serif text-xl md:text-2xl font-semibold">
          </h2>
          <p id="lightbox-category" class="text-beige-premium/80 text-sm mt-1"></p>
        </div>
      </div>

      <!-- Image counter -->
      <div
        class="absolute bottom-4 md:bottom-8 left-1/2 -translate-x-1/2 px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full"
      >
        <span id="lightbox-counter" class="text-white text-sm font-medium"></span>
      </div>
    </div>

    <!-- CTA Section -->
    <section class="py-24 md:py-32 relative overflow-hidden">
      <!-- Background with gradient -->
      <div
        class="absolute inset-0 bg-gradient-to-br from-verde-oliva via-verde-oliva to-negro-suave"
      >
      </div>

      <!-- Decorative circles -->
      <div
        class="absolute top-0 left-0 w-96 h-96 bg-white/5 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2"
      >
      </div>
      <div
        class="absolute bottom-0 right-0 w-80 h-80 bg-cafe-claro/10 rounded-full blur-3xl translate-x-1/3 translate-y-1/3"
      >
      </div>

      <!-- Content -->
      <div class="container mx-auto px-4 sm:px-6 lg:px-8 relative z-10 text-center">
        <div
          class="inline-flex items-center gap-2 px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full mb-8"
        >
          <svg
            class="w-5 h-5 text-beige-premium"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
            ></path>
          </svg>
          <span class="text-beige-premium font-medium text-sm tracking-wider uppercase"
            >Vive la experiencia</span
          >
        </div>

        <h2
          class="font-serif text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-6 leading-tight"
        >
          ¿Te gustó lo que viste?
        </h2>
        <p class="text-beige-premium/90 text-lg md:text-xl mb-12 max-w-2xl mx-auto leading-relaxed">
          Vive la experiencia en persona. Reserva tu estadía y descubre todo lo que tenemos
          preparado para ti.
        </p>

        <div class="flex flex-col sm:flex-row justify-center gap-4">
          <a
            href="https://hotels.cloudbeds.com/es/reservation/QZE4hg?currency=cop"
            target="_blank"
            rel="noopener noreferrer"
            class="group inline-flex items-center justify-center gap-3 font-medium rounded-full transition-all duration-500 bg-white text-verde-oliva hover:bg-beige-premium hover:shadow-xl hover:shadow-white/20 px-10 py-4 text-lg"
          >
            <span>Reservar Ahora</span>
            <svg
              class="w-5 h-5 transform group-hover:translate-x-1 transition-transform duration-300"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
          </a>
          <a
            href="/contacto"
            class="group inline-flex items-center justify-center gap-3 font-medium rounded-full transition-all duration-500 bg-transparent text-white hover:bg-white/10 px-10 py-4 text-lg border-2 border-white/50 hover:border-white"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
              ></path>
            </svg>
            <span>Contactar</span>
          </a>
        </div>
      </div>
    </section>
  </main>

  <Footer />
</Layout>

<style>
  /* Animations */
  @keyframes fade-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes fade-in-up {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes gallery-item-in {
    from {
      opacity: 0;
      transform: translateY(30px) scale(0.95);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  .animate-fade-in {
    animation: fade-in 0.8s ease-out forwards;
  }

  .animate-fade-in-up {
    animation: fade-in-up 0.8s ease-out forwards;
    opacity: 0;
  }

  .gallery-item {
    animation: gallery-item-in 0.6s ease-out forwards;
    opacity: 0;
  }

  /* Filter transition styles */
  .gallery-item.filtering-out {
    opacity: 0 !important;
    transform: scale(0.8) !important;
    pointer-events: none;
  }

  .gallery-item.hidden {
    display: none !important;
  }

  /* Lightbox active state */
  #lightbox.active {
    opacity: 1;
    pointer-events: auto;
  }

  #lightbox.active #lightbox-img {
    transform: scale(1);
  }

  /* Active filter button badge */
  .filter-btn.active .count-badge {
    transform: scale(1) !important;
  }
</style>

<script>
  // Gallery filter functionality
  const filterButtons = document.querySelectorAll('.filter-btn');
  const galleryItems = document.querySelectorAll('.gallery-item');
  const visibleCountEl = document.getElementById('visible-count');

  // Lightbox elements
  const lightbox = document.getElementById('lightbox');
  const lightboxImg = document.getElementById('lightbox-img') as HTMLImageElement;
  const lightboxTitle = document.getElementById('lightbox-title');
  const lightboxCategory = document.getElementById('lightbox-category');
  const lightboxCounter = document.getElementById('lightbox-counter');
  const lightboxClose = document.getElementById('lightbox-close');
  const lightboxPrev = document.getElementById('lightbox-prev');
  const lightboxNext = document.getElementById('lightbox-next');

  let currentImageIndex = 0;
  let visibleImages: HTMLElement[] = [];

  // Filter functionality
  filterButtons.forEach((button) => {
    button.addEventListener('click', () => {
      const category = button.getAttribute('data-category');

      // Update active button
      filterButtons.forEach((btn) => {
        btn.classList.remove(
          'bg-verde-oliva',
          'text-white',
          'shadow-lg',
          'shadow-verde-oliva/25',
          'active'
        );
        btn.classList.add('bg-beige-premium/50', 'text-negro-suave');
        const badge = btn.querySelector('.count-badge');
        if (badge) badge.classList.remove('scale-100');
      });
      button.classList.add(
        'bg-verde-oliva',
        'text-white',
        'shadow-lg',
        'shadow-verde-oliva/25',
        'active'
      );
      button.classList.remove('bg-beige-premium/50', 'text-negro-suave');
      const activeBadge = button.querySelector('.count-badge');
      if (activeBadge) activeBadge.classList.add('scale-100');

      // Filter gallery items with animation
      let visibleCount = 0;
      galleryItems.forEach((item) => {
        const el = item as HTMLElement;
        const itemCategory = item.getAttribute('data-category');

        if (category === 'Todas' || itemCategory === category) {
          visibleCount++;
          el.classList.remove('filtering-out');
          setTimeout(() => {
            el.classList.remove('hidden');
            // Re-trigger animation
            el.style.animation = 'none';
            el.offsetHeight; // Trigger reflow
            el.style.animation = `gallery-item-in 0.6s ease-out forwards`;
            el.style.animationDelay = `${visibleCount * 0.05}s`;
          }, 10);
        } else {
          el.classList.add('filtering-out');
          setTimeout(() => {
            el.classList.add('hidden');
          }, 300);
        }
      });

      // Update counter
      if (visibleCountEl) {
        visibleCountEl.textContent = visibleCount.toString();
      }

      // Update visible images array for lightbox
      updateVisibleImages();
    });
  });

  // Update visible images for lightbox navigation
  function updateVisibleImages() {
    visibleImages = Array.from(galleryItems).filter(
      (item) => !item.classList.contains('hidden')
    ) as HTMLElement[];
  }

  // Initialize visible images
  updateVisibleImages();

  // Lightbox functionality
  galleryItems.forEach((item) => {
    item.addEventListener('click', () => {
      const el = item as HTMLElement;
      const src = el.getAttribute('data-src');
      const title = el.getAttribute('data-title');
      const category = el.getAttribute('data-category');

      if (src && lightbox && lightboxImg && lightboxTitle && lightboxCategory && lightboxCounter) {
        currentImageIndex = visibleImages.indexOf(el);
        lightboxImg.src = src;
        lightboxTitle.textContent = title || '';
        lightboxCategory.textContent = category || '';
        lightboxCounter.textContent = `${currentImageIndex + 1} / ${visibleImages.length}`;
        lightbox.classList.add('active');
        document.body.style.overflow = 'hidden';
      }
    });
  });

  // Close lightbox
  function closeLightbox() {
    if (lightbox) {
      lightbox.classList.remove('active');
      document.body.style.overflow = '';
    }
  }

  lightboxClose?.addEventListener('click', closeLightbox);
  lightbox?.addEventListener('click', (e) => {
    if (e.target === lightbox) closeLightbox();
  });

  // Navigate lightbox
  function navigateLightbox(direction: number) {
    currentImageIndex += direction;
    if (currentImageIndex < 0) currentImageIndex = visibleImages.length - 1;
    if (currentImageIndex >= visibleImages.length) currentImageIndex = 0;

    const item = visibleImages[currentImageIndex];
    if (item && lightboxImg && lightboxTitle && lightboxCategory && lightboxCounter) {
      lightboxImg.src = item.getAttribute('data-src') || '';
      lightboxTitle.textContent = item.getAttribute('data-title') || '';
      lightboxCategory.textContent = item.getAttribute('data-category') || '';
      lightboxCounter.textContent = `${currentImageIndex + 1} / ${visibleImages.length}`;
    }
  }

  lightboxPrev?.addEventListener('click', () => navigateLightbox(-1));
  lightboxNext?.addEventListener('click', () => navigateLightbox(1));

  // Keyboard navigation
  document.addEventListener('keydown', (e) => {
    if (!lightbox?.classList.contains('active')) return;

    switch (e.key) {
      case 'Escape':
        closeLightbox();
        break;
      case 'ArrowLeft':
        navigateLightbox(-1);
        break;
      case 'ArrowRight':
        navigateLightbox(1);
        break;
    }
  });

  // Show first filter badge on load
  const firstButton = filterButtons[0];
  if (firstButton) {
    firstButton.classList.add('active');
    const badge = firstButton.querySelector('.count-badge');
    if (badge) badge.classList.add('scale-100');
  }
</script>
