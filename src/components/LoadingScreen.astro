<div
  id="loading-screen"
  class="loading-screen fixed inset-0 z-[9999] flex items-center justify-center transition-opacity duration-500 ease-out"
  style="display: none;"
>
  <div class="text-center">
    <h1 id="loading-title" class="font-serif text-3xl md:text-4xl font-bold mb-8 animate-fade-in">
      Hotel Bot√°nico
    </h1>
    <div class="flex items-center justify-center mb-6">
      <div class="relative w-16 h-16 md:w-20 md:h-20">
        <div id="spinner-outer" class="spinner-outer absolute inset-0 border-4 rounded-full"></div>
        <div
          id="spinner-inner"
          class="spinner-inner absolute inset-0 border-4 border-transparent rounded-full animate-spin-slow"
        >
        </div>
      </div>
    </div>
    <p id="loading-text" class="text-sm md:text-base font-light tracking-wide animate-pulse">
      Cargando...
    </p>
  </div>
</div>

<style>
  @keyframes spin-slow {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  .animate-spin-slow {
    animation: spin-slow 1.5s linear infinite;
  }

  .animate-fade-in {
    animation: fadeIn 0.8s ease-out;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  #loading-screen.fade-out {
    opacity: 0;
    pointer-events: none;
  }

  .loading-screen.theme-light {
    background-color: #ebe2db;
  }
  .loading-screen.theme-light #loading-title {
    color: #615a40;
  }
  .loading-screen.theme-light #spinner-outer {
    border-color: rgba(164, 141, 117, 0.2);
  }
  .loading-screen.theme-light #spinner-inner {
    border-top-color: #615a40;
  }
  .loading-screen.theme-light #loading-text {
    color: #a48d75;
  }

  .loading-screen.theme-dark {
    background-color: #111111;
  }
  .loading-screen.theme-dark #loading-title {
    color: #ebe2db;
  }
  .loading-screen.theme-dark #spinner-outer {
    border-color: rgba(235, 226, 219, 0.2);
  }
  .loading-screen.theme-dark #spinner-inner {
    border-top-color: #a48d75;
  }
  .loading-screen.theme-dark #loading-text {
    color: rgba(235, 226, 219, 0.8);
  }
</style>

<script is:inline>
  (function () {
    'use strict';
    var loadingScreen = document.getElementById('loading-screen');
    if (!loadingScreen) return;

    var isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    loadingScreen.classList.add(isDark ? 'theme-dark' : 'theme-light');

    loadingScreen.style.display = 'flex';

    var hidden = false;
    var resourcesReady = {
      dom: false,
      fonts: false,
      heroImage: false,
    };

    function checkAllResourcesReady() {
      if (resourcesReady.dom && resourcesReady.fonts && resourcesReady.heroImage) {
        hideLoading();
      }
    }

    function hideLoading() {
      if (hidden || !loadingScreen) return;
      hidden = true;
      loadingScreen.classList.add('fade-out');

      var heroCarousel = document.querySelector('.hero-carousel');
      if (heroCarousel) {
        heroCarousel.classList.remove('carousel-paused');

        var firstSlide = heroCarousel.querySelector('.carousel-slide:nth-child(1)');
        if (firstSlide) {
          firstSlide.style.opacity = '1';
          firstSlide.style.transform = 'scale(1)';
        }
      }

      setTimeout(function () {
        if (document.dispatchEvent) {
          var event = new CustomEvent('loading-complete');
          document.dispatchEvent(event);
        }

        if (typeof window !== 'undefined' && window.initNavbar) {
          window.initNavbar();
        }
      }, 100);

      setTimeout(function () {
        if (loadingScreen && loadingScreen.parentNode) {
          loadingScreen.remove();
        }
      }, 500);
    }

    function waitForDOM() {
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function () {
          resourcesReady.dom = true;
          checkAllResourcesReady();
        });
      } else {
        resourcesReady.dom = true;
        checkAllResourcesReady();
      }
    }

    function waitForFonts() {
      if (document.fonts && document.fonts.ready) {
        document.fonts.ready
          .then(function () {
            resourcesReady.fonts = true;
            checkAllResourcesReady();
          })
          .catch(function () {
            setTimeout(function () {
              resourcesReady.fonts = true;
              checkAllResourcesReady();
            }, 1000);
          });
      } else {
        setTimeout(function () {
          resourcesReady.fonts = true;
          checkAllResourcesReady();
        }, 1000);
      }
    }

    function waitForHeroImage() {
      function checkHeroImage() {
        var heroImage = document.querySelector('.carousel-slide img[fetchpriority="high"]');

        if (!heroImage) {
          setTimeout(function () {
            resourcesReady.heroImage = true;
            checkAllResourcesReady();
          }, 500);
          return;
        }

        if (heroImage.complete && heroImage.naturalHeight !== 0) {
          resourcesReady.heroImage = true;
          checkAllResourcesReady();
          return;
        }

        var imageLoaded = false;
        function onImageLoad() {
          if (!imageLoaded) {
            imageLoaded = true;
            resourcesReady.heroImage = true;
            checkAllResourcesReady();
          }
        }

        heroImage.addEventListener('load', onImageLoad);
        heroImage.addEventListener('error', function () {
          if (!imageLoaded) {
            imageLoaded = true;
            resourcesReady.heroImage = true;
            checkAllResourcesReady();
          }
        });

        var checkInterval = setInterval(function () {
          if (heroImage.complete && heroImage.naturalHeight !== 0) {
            clearInterval(checkInterval);
            if (!imageLoaded) {
              imageLoaded = true;
              resourcesReady.heroImage = true;
              checkAllResourcesReady();
            }
          }
        }, 100);

        setTimeout(function () {
          clearInterval(checkInterval);
        }, 10000);
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', checkHeroImage);
      } else {
        setTimeout(checkHeroImage, 100);
      }
    }

    waitForDOM();
    waitForFonts();
    waitForHeroImage();

    setTimeout(function () {
      if (!hidden) {
        resourcesReady.dom = true;
        resourcesReady.fonts = true;
        resourcesReady.heroImage = true;
        hideLoading();
      }
    }, 5000);
  })();
</script>
